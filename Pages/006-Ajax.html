<!DOCTYPE html>
<html>
<head>

	<title>Ajax</title>

	<meta charset="utf-8">

	<script src="https://code.jquery.com/jquery-1.9.1.js"></script>
	<script src="jquerycookie.js"></script>

	<script type="text/javascript" src="https://jhmiante.github.io/Js/jquerycookie.js"></script>
	
	<link rel="stylesheet" type="text/css" href="https://jhmiante.github.io/Css/estiloCurso.css">

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
</head>
<body>

	<div id="top-menu"></div>
	<script type="text/javascript" src="https://jhmiante.github.io/Js/top-menu.js"></script>


<br><br><br><br>
	<h1 class="text-center">Ajax</h1>

	<div class="DivClass">
		<h2>Armazenamento de informação em JS</h2>

		<p>
			Basicamente temos duas formas de armazenar dados no cliente:
		</p>

        <ul>
			<li>Através de cookies (modelo bem antigo de armazenamento de dados no cliente)</li>
			<li>API Web Storage (API disponibilizada com o surgimento do HTML5)</li>
        </ul>

		<p>
			Embora a API Web Storage tenha diversas vantagens sobre o uso de cookies, iremos abordar os dois conteúdos, 
			visto que também podemos manipular cookies em linguagens server-side e porque muitos projetos ainda utilizam esse recurso.
		</p>
	</div>

    <div class="DivClass">
		<h2>Cookies</h2>

		<p>
			São informações gravadas por uma aplicação web na máquina cliente. Para cada domínio
			da aplicação, é gerado um arquivo txt, que contém os cookies.
		</p>
		<p>Os cookies são formados por um par composto de:</p>
		<ul>
			<li>Nome do cookie</li>
			<li>Valor do cookie</li>
		</ul>

		<p>
			Os cookies são mantidos na máquina cliente enquanto seu prazo de “vida” não expirar ou
			enquanto o usuário não limpá-los através do navegador
		</p>

		<p>
			Como padrão, podemos criar cookies de até 10Kb. Isso quer dizer que podemos ter um
			cookie de 10k ou 50 cookies no máximo, que totalizam juntos 10k. Esses valores correspondem
			aos cookies de um determinado domínio. Esses valores podem variar conforme o browser.
		</p>

		<hr />

		<h3>Para que usar cookies?</h3>

		<p>Para gravar algumas informações que, posteriormente, poderemos usar em nossa aplicação web.</p>

		<p>
			Em um exemplo clássico, podemos trabalhar com os cookies em um e-commerce. Enquanto
			o usuário está fazendo a escolha dos pedidos e colocando-os no carrinho de compra, podemos
			armazenar os dados dos produtos em cookies. Após a finalização da compra, gravamos os
			dados em um banco de dados e limpamos o cookie.
		</p>

		<p>Vamos testar essa ideia usando o site do Submarino.</p>

		<p>
			Qualquer site pode gravar cookies em sua máquina, desde que essa permissão esteja
			habilitada em seu navegador.
		</p>

		<p>Um cookie não pode apagar arquivos em sua máquina e muito menos “roubar” suas senhas.</p>

		<p>
			Um site só pode acessar os cookies gravados pelo seu domínio, ou seja, uma aplicação só
			pode acessar os cookies gravados por ela.
		</p>

        <hr />

		<h3>Como é composto um cookie?</h3>

		<h4>Um cookie é composto por:</h4>

		<ul>
			<li>Nome</li>
			<li>Valor</li>
			<li>Tempo (tempo de validade do cookie)</li>
		</ul>

		<p>Podemos manipular os cookies em JavaScript através do comando:</p>
        <p><i>document.cookie</i></p>

		<h4>Um cookie é composto basicamente por:</h4>

        <p><i>NAME = Valor; EXPIRES = Data; PATH = Caminho; DOMAIN = Nome_Dominio.</i></p>

		<p><b>NAME:</b> é uma string de caracteres usada para identificar o cookie.</p>

		<p>
			<b>EXPIRES:</b> é a data em que o cookie deve ser removido do arquivo de cookies se ele ainda
			estiver lá. Não sendo especificada nenhuma data, o cookie terá sua validade vencida assim que
			o usuário sair do browser e encerrar a sessão.
		</p>

		<p>
			<b>PATH:</b> é o nome do caminho ou URL do documento que criou o cookie (motivo privacidade)
		</p>

		<p>
			<b>DOMAIN:</b> é o nome completo do domínio do servidor (ou computador central) que
			criou o cookie.
		</p>

	</div>

	<div class="DivClass">
		
		<h2>Cookies com jQuery</h2>

		<p>
			Podemos manipular os cookies facilmente utilizando um plugin para o jQuery
		</p>

		<div class="Exemplo">
			<p>Plugin cookie para o jQuery</p>
			<p><a href="https://github.com/carhartl/jquery-cookie">https://github.com/carhartl/jquery-cookie</a></p>
		</div>

		<ul>
			<li>
				para gravar um cookie <br>
				<i>$.cookie(“nomedocookie”, “valor do cookie”);</i>
			</li>

			<li>
				para definir uma prazo de expiração (10 dias no exemplo)<br>
				<i>$.cookie(“nomedocookie”, “valor do cookie”, { expires: 10 });</i>
			</li>

			<li>
				para recuperar os dados do cookie <br>	
				<i>$.cookie(“nomedocookie”)</i>
			</li>

			<li>
				para apagar um cookie <br>
				<i>$.removeCookie(“nomedocookie”, null);</i>
			</li>
		</ul>

		<hr>

		<h3>Vejamos, na prática, a utilização do cookie.</h3>
		
		<div class="CodHtml">
			&lt;!-- Código HTML --><br><br>

			&lt;form id="form1" name="form1" method="post" action=""><br>
				&lt;p><br>
					RGM:<br>
					&lt;input type="text" name="rgm" id="rgm" size="10"><br>
				&lt;/p><br>
				&lt;p><br>
					Nome:<br>
					&lt;input type="text" name="nome" id="nome" size="60"><br>
				&lt;/p><br>
				&lt;p><br>
					Profissão:<br>
					&lt;input type="text" name="profissao" id="profissao" size="60"><br>
				&lt;/p><br>
				&lt;p><br>
					CPF:<br>
					&lt;input type="text" name="cpf" id="cpf" size="20"><br>
				&lt;/p><br>
				&lt;p><br>
					&lt;input type="button" name="button" id="button1" value="Gravar Cookies"><br>
					&lt;input type="button" name="button2" id="button2" value="Carregar Cookies"><br>
					&lt;input type="button" name="button3" id="button3" value="Eliminar Cookies"><br>
				&lt;/p><br>
			&lt;/form><br>

		</div>

		<img src="img/cookie.png" class="imgClass">	

		<div class="Exemplo">
			<p>Abaixo, um formulário contendo alguns campos.</p>
			<hr>
			<form id="form1" name="form1" method="post" action="">
				<p>
					RGM:
					<input type="text" name="rgm" id="rgm" size="10">
				</p>
				<p>
					Nome:
					<input type="text" name="nome" id="nome" size="60">
				</p>
				<p>
					Profissão:
					<input type="text" name="profissao" id="profissao" size="60">
				</p>
				<p>
					CPF:
					<input type="text" name="cpf" id="cpf" size="20">
				</p>
				<p>
					<input type="button" name="button1" id="button1" value="Gravar Cookies">
					<input type="button" name="button2" id="button2" value="Carregar Cookies">
					<input type="button" name="button3" id="button3" value="Eliminar Cookies">
				</p>
			</form>

			<p>//CÓDIGO APOSTILA - NÃO FUNCIONANDO - VERIFICAR</p>
		</div>

	</div>

	<div class="DivClass">
		
		<h2>Web Storage (HTML5)</h2>

		<p>
			Com essa API, o desenvolvimento fica mais fácil e temos algumas vantagens sobre os
			cookies; a mais significativa seria a capacidade de armazenamento, que varia, de acordo com o
			navegador, de 5MB até 10MB (IE).
		</p>

		<p>
			A Web Storage oferece dois tipos de armazenamento: <b>sessionStorage e localStorage.</b>
		</p>

		<h3>sessionStorage</h3>
		<p>
			Disponível apenas para a janela (aba) que criou o dado até que esta seja fechada.
		</p>

		<h3>localStorage</h3>
		<p>
			Compartilhada por todas as janelas (abas) abertas pela aplicação, e os dados só são
			apagados caso sejam deletados pela aplicação ou pelo usuário.
		</p>

		<hr>

		<h3>Como usar (os métodos são os mesmos para o objeto sessionStorage e localStorage):</h3>

		<h4>Para gravar dados:</h4>
		<p><i>setItem(nome, valor)</i></p>
		<p>
			Ex: localStorage.setItem(“nome”,”Maria”);<br>
			Ex: sessionStorage.setItem(“nome”,”Maria”);
		</p>

		<h4>Para recuperar dados gravados:</h4>
		<p><i>getItem(nome)</i></p>
		<p>
			Ex: localStorage.getItem(“nome”)<br>
			Ex: sessionStorage.getItem(“nome”)
		</p>

		<h4>Para apagar dados gravados:</h4>
		<p><i>removeItem(nome)</i></p>
		<p>
			Ex: localStorage.removeItem(“nome”)<br>
			Ex: sessionStorage.removeItem(“nome”)
		</p>

		<h4>Para apagar todos os dados do storage:</h4>
		<p><i>clear()</i></p>
		<p>
			Ex: localStorage.clear()<br>
			Ex: sessionStorage.clear()
		</p>

		<p>
			Vejamos, na prática, a utilização do webstorage. Essas funções podem ser utilizadas no
			mesmo formulário que foi exibido no item de cookie.			
		</p>

		<div class="CodClass">
			//LOCALSTORAGE 
		</div>

		<img src="img/localStorage.png" class="imgClass">

		<div class="Exemplo">
			<p>Abaixo, um formulário contendo alguns campos.</p>
			<hr>
			<form id="form2" name="form2" method="post" action="">
				<p>
					RGM:
					<input type="text" name="rgm2" id="rgm2" size="10">
				</p>
				<p>
					Nome:
					<input type="text" name="nome2" id="nome2" size="60">
				</p>
				<p>
					Profissão:
					<input type="text" name="profissao2" id="profissao2" size="60">
				</p>
				<p>
					CPF:
					<input type="text" name="cpf2" id="cpf2" size="20">
				</p>
				<p>
					<input type="button" name="button4" id="button4" value="Gravar Cookies">
					<input type="button" name="button5" id="button5" value="Carregar Cookies">
					<input type="button" name="button6" id="button6" value="Eliminar Cookies">
				</p>
			</form>
		</div>

	</div>

	<div class="DivClass">
		
		<h2>Ajax</h2>

		<p>
			O jQuery oferece uma vasta documentação para se trabalhar as requisições AJAX. Quando
			trabalhamos com AJAX, utilizamos um objeto nativo dos navegadores que permite a comunicação
			assíncrona com o servidor. 
		</p>

		<h3>Objeto XMLHttpRequest</h3>
		<p>
			O objeto utilizado no AJAX é o XMLHttpRequest, manipulado através de javascript e que efetua a comunicação com o servidor através de requisições HTTP. <br>

			É um objeto nativo padronizado nos navegadores atuais, mas implementado como controle ActiveX nas versões antigas do Internet Explorer, isto é, 5 e 6. Isso significa que, antes de criá-lo, é necessário fazer uma verificação. <br>

			Os métodos disponíveis são apenas dois: open() para abrir a requisição e send() para enviar os dados. E, para receber, a propriedade é a ResponseXML.
		</p>

		<img src="img/ajax00.png" class="imgClass">

		<p>
			Toda a comunicação e verificação é feita pela função do jQuery; precisamos apenas informar os dados. Sendo assim, vamos à primeira função.
		</p>

		<hr>

		<h3>$.ajax()</h3>

		<p>
			É a função que mais oferece funcionalidades e, devido a isso, exige um pouco mais de estudo para ser compreendida. <br>

			E todas as funções mais específicas que serão apresentadas adiante utilizam esta função para iniciar as requisições. <br>

			Para haver a requisição, você precisa informar um seletor que vai dar início à execução, o endereço do arquivo que contém os dados que serão retornados, o tipo de dado retornado e o que será feito com ele.
		</p>

		<img src="img/ajax01.png" class="imgClass">

		<br>

		<p>
			Quando o botão “enviar” do formulário for clicado, será iniciada a requisição. Utilizando o método POST, que é mais seguro para dados sensíveis, em seguida enviamos a dupla variável/valor para o arquivo 'info.php'. Havendo sucesso na requisição, as informações retornadas pelo arquivo serão mostradas em uma div. <br>
			Não chega a ser tão complicado quanto eu disse, não é mesmo?
		</p>

		<hr>
		<h3>Configurações</h3>

		<p>Vejamos, agora, as opções disponíveis. Essas informações podem ser encontradas na biblioteca do jQuery.</p>

		<ul>
			<li>
				asinc – Como a requisição é feita com AJAX, ela é assíncrona. Se você quiser sincronizar
				a requisição, deve setar true para esta variável. Mas aviso que pode causar instabilidade
				na aplicação.
			</li>
			<br>
			<li>
				beforeSend – Para alterar o cabeçalho da requisição ou realizar operações antes do envio
				da requisição, utilize esta função.
			</li>
			<br>
			<li>
				cache – As páginas requisitadas via ajax() são armazenadas pelo navegador para agilizar o processo. Se você não quer que a página fique em cache, atribua false.
			</li>
			<br>
			<li>
				complete – Completando a requisição, esta função define o que deve ser feito. Vem depois das funções success e error.
			</li>
			<br>
			<li>
				contentType – Define o myme type da requisição. O padrão é application/x-ww-formurlencoded. que é o myme type enviado quando submetemos formulários.
			</li>
			<br>
			<li>
				data – São os dados que serão passados para o arquivo definido em url. O formato deve ser variável/valor e, se você não deixar nesta formatação, a função formatará automaticamente.
			</li>
			<br>
			<li>
				dataFilter – A função é garantir que os dados retornados estejam nas diretrizes esperadas
			</li>
			<br>
			<li>
				dataType – Você define qual o tipo de dado a ser retornado pela requisição. Os valores possíveis são: xml, html, json, sjonp, script e text. Configurando esta opção, você permite uma avaliação dos dados que são retornados. Se esta opção for omitida, a função identifica o tipo de dado, mas não avalia.
			</li>
			<br>
			<li>
				error – Função que entra em ação caso a requisição retorne erro.
			</li>
			<br>
			<li>
				global – Indica se os eventos manipuladores definidos em .ajaxSend() e .ajaxError() valerão na requisição atual. Por padrão está setado para true.
			</li>
			<br>
			<li>
				ifModified – Se você quer que uma requisição seja retornada somente se o conteúdo dele mudou em relação à última requisição, configure esta variável para true
			</li>
			<br>
			<li>
				processData – Esta variável é configurada para processar e transformar as informações passadas para o padrão application/x-www-form-urlencoded. Se, por algum motivo, você não quer esta formatação, como mandar no formato xml para o servidor, atribua false para esta variável.
			</li>
			<br>
			<li>
				password e username– Senha e usuário a serem utilizados em caso de autenticação HTTP.
			</li>
			<br>
			<li>
				successs – A requisição retornando sucesso, é executada esta função, que recebe os dados enviados pelo arquivo
			</li>
			<br>
			<li>
				timeout – Se você quer limitar o tempo para a execução da requisição, defina um valor em milissegundos. Não retornando sucesso dentro do tempo definido, uma mensagem de erro, configurada por você na função error, será mostrada.
			</li>
			<br>
			<li>
				type – O método usado para a requisição. Aceita GET ou POST. O padrão é GET
			</li>
			<br>
			<li>
				url – Endereço do arquivo que receberá a requisição.
			</li>
		</ul>

		<p>
			Existem outras configurações, mas conhecer essas acima acredito que seja suficiente para realizar as atividades.
		</p>

		<hr>
		<h3>Fazendo uma requisição</h3>
		<p>
			Vamos, então, a um exemplo aplicado do que vimos acima.
		</p>

		<img src="img/ajax02.png" class="imgClass">

		<br>

		<h3>
			Vamos à explicação: 
		</h3>

		<p>
			A função inicia-se passando o nome do arquivo que receberá as informações, o tipo de requisição e os dados. O objeto data aceita a combinação de variável/valor já encapsulada com os símbolos (& e =) ou como apresentado acima. Nesse caso, os dados são formatados antes de serem enviados. E fica mais organizado. <br><br>
			
			Em seguida, definimos que os dados retornados serão do tipo HTML, e também informamos o usuário e senha (no exemplo, o servidor exige autenticação). Antes de enviar, informamos ao usuário o que está acontecendo, tornando visível a div com uma animação de carregamento (fade in). <br><br>
			
			Em um último ajuste, é definido que a requisição deve durar, no máximo, três segundos (3000 milissegundos). Se esse tempo for ultrapassado, a função error entra em ação e apresenta uma mensagem descrevendo o erro. <br><br>

			Tudo acertado e a requisição sendo um sucesso, com retorno de informação, a div ‘#resposta’ recebe os dados.
		</p>

	</div>

	<script type="text/javascript" src="https://jhmiante.github.io/Js/Ajax.js"></script>
</body>
</html>